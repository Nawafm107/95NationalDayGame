<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„Ø¹Ø¨Ø© Ø§Ù„Ø§Ø³Ø¦Ù„Ø©</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
</head>
<body dir="rtl">
    <div class="start_btn">
        <button id="start-quiz-btn">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø©</button>
        
        <button class="show-leaderboard-btn" style="margin-top:15px;width:100%">Ø¹Ø±Ø¶ Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†</button>
    </div>

    <div class="quiz_box">
        <header>
            <div class="title">Ø¹Ø²Ù†Ø§ Ø¨Ø·Ø¨Ø¹Ù†Ø§</div>
            <div class="timer">
                <div class="time_left_txt">Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</div>
                <div class="timer_sec">60</div>
            </div>
            <div class="time_line"></div>
        </header>
        <section>
            <div class="que_text"></div>
            <div class="option_list"></div>
        </section>

        <footer>
            <div class="total_que"></div>
            <button class="next_btn">Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ</button>
        </footer>
    </div>
    
    <div class="result_box">
        <div class="complete_text">Ù„Ù‚Ø¯ Ø§Ù†Ù‡ÙŠØª Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø© ğŸ¥³</div>
        <div class="score_text"></div>
        <div class="buttons">
            <button class="restart">Ø§Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø³Ø¦Ù„Ø©</button>
            <button class="quit">Ø§Ù„Ø®Ø±ÙˆØ¬</button>
        </div>
        <button class="show-leaderboard-btn" style="margin-top:10px;width:100%">Ø¹Ø±Ø¶ Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†</button>
    </div>

    <script src="js/questions.js"></script>
    <script src="js/script.js"></script>
    <script type="module">
    // Ø²Ø± Ø¹Ø±Ø¶ Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† ØªØ­Øª Ø²Ø± Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
    document.querySelectorAll('.show-leaderboard-btn').forEach(btn => {
        btn.onclick = () => {
            if (typeof showLeaderboard === 'function') {
                showLeaderboard();
            }
        };
    });

    // Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØµÙØ­Ø© ØªØ±Ø­ÙŠØ¨ Ù„Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø³Ù‡Ù„ Ø¨Ø¹Ø¯ Ø§Ù„Ø¢Ù†ØŒ Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ ÙƒÙˆØ¯ ÙŠØ®Øµ welcome_box
    // Import SDKs Ù…Ù† CDN
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-analytics.js";
    import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

    // Config
    const firebaseConfig = {
        apiKey: "AIzaSyBR3cYuAwAuOMs2MtisFI3rmWFsEv-n8N8",
        authDomain: "leader-board-da464.firebaseapp.com",
        databaseURL: "https://leader-board-da464-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "leader-board-da464",
        storageBucket: "leader-board-da464.firebasestorage.app",
        messagingSenderId: "562083629862",
        appId: "1:562083629862:web:92ce91063127961b08cfe7",
        measurementId: "G-09TFYFR6VF"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const db = getDatabase(app);

    // --- ÙƒÙˆØ¯ Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† ---
    // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù„ÙˆØ­Ø©
    const leaderboardBox = document.createElement('div');
    leaderboardBox.className = 'leaderboard_box';
    leaderboardBox.style.display = 'none';
    leaderboardBox.innerHTML = `
        <div class="info-title"><span>Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†</span></div>
        <div class="leaderboard-list"></div>
        <div class="buttons">
            <button class="quit">Ø§ØºÙ„Ø§Ù‚</button>
        </div>
    `;
    document.body.appendChild(leaderboardBox);
    const leaderboardList = leaderboardBox.querySelector('.leaderboard-list');
    const leaderboardQuit = leaderboardBox.querySelector('.buttons .quit');

    leaderboardQuit.onclick = () => {
        leaderboardBox.style.display = 'none';
    };

    function showLeaderboard() {
        leaderboardBox.style.display = 'block';
        leaderboardBox.classList.add('activeLeaderboard');
        leaderboardList.innerHTML = '<div>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>';
        const scoresRef = ref(db, 'scores');
        onValue(scoresRef, (snapshot) => {
            const data = snapshot.val();
            if (!data) {
                leaderboardList.innerHTML = '<div>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¹Ø¯.</div>';
                return;
            }
            // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù…ØµÙÙˆÙØ© ÙˆØªØ±ØªÙŠØ¨Ù‡Ø§ ØªÙ†Ø§Ø²Ù„ÙŠØ§Ù‹
            const arr = Object.entries(data).map(([name, score]) => ({ name, score }));
            arr.sort((a, b) => b.score - a.score);
            leaderboardList.innerHTML = arr.map((item, i) =>
                `<div style=\"font-size:22px;margin:8px 0;display:flex;justify-content:space-between;\">
                    <span>${i+1}. ${item.name}</span>
                    <span>${item.score}</span>
                </div>`
            ).join('');
        }, { onlyOnce: true });
    }

    // Ø­ÙØ¸ Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø­Ø¯Ø« Ù…Ù† script.js
    window.addEventListener('saveScore', e => {
        const { playerName, score } = e.detail;
        try {
            set(ref(db, 'scores/' + playerName), score);
        } catch(e) { /* ØªØ¬Ø§Ù‡Ù„ Ø£ÙŠ Ø®Ø·Ø£ */ }
    });

    // --- Ù†Ù‡Ø§ÙŠØ© ÙƒÙˆØ¯ Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† ---
    </script>

</body>
</html>
